# プロジェクト要件定義書：設計業務 進捗・工数管理システム

## 1. 概要
本プロジェクトは、GoogleスプレッドシートおよびGoogle Apps Scriptを用いて、設計業務の進捗と工数を管理するシステムを構築する。「メインシート」を全案件のマスターデータとし、担当者ごとの「工数シート」と連携させる。データの入力と同期を自動化し、管理業務の効率化と正確性の向上を目指す。

---

## 2. シート構成と役割

### 2.1. マスターシート群
| シート名 | 役割 |
| :--- | :--- |
| **メインシート** | 全案件のマスターデータを管理する。すべての情報の原本となる。 |
| **担当者マスタ** | システムで管理する全担当者の**名前**と**メールアドレス**を定義する。 |
| **進捗マスタ** | 「未着手」「完了」など、進捗ステータスの選択肢を定義する。 |
| **作業区分マスタ** | 「盤配」「線加工」など、作業区分の選択肢を定義する。 |
| **問い合わせマスタ** | 「問合済」「回答済」など、問い合わせステータスの選択肢を定義する。 |

### 2.2. 作業用シート
| シート名 | 役割 |
| :--- | :--- |
| **工数\_{担当者名}** | 担当者ごとに自動で運用される作業用シート。日々の工数入力と進捗更新を行う。 |
| **請求シート** | メインシートの情報を基に、請求用に整形されたデータが自動で出力されるシート。 |

---

## 3. 列構成

### 3.1. メインシート
| 列 | 列ヘッダー名 | 内容・役割 |
| :--- | :--- | :--- |
| **A** | **管理No** | 案件を一位に特定する管理番号 |
| **B** | **作業区分** | 「盤配」「線加工」を選択 |
| **C** | **機番** | 製品の機番 |
| **D** | **機種** | 製品の機種名 |
| **E** | **機番(リンク)** | 製番資料フォルダへのリンク（自動生成） |
| **F** | **STD資料(リンク)**| STD資料フォルダへのリンク（自動生成） |
| **G** | **参考製番** | 参考にする過去の製番 |
| **H** | **回路図番** | 回路図の図面番号 |
| **I** | **問い合わせ** | 問い合わせ状況 |
| **J** | **仮コード** | 仮のコード番号 |
| **K** | **担当者** | 設計の主担当者 |
| **L** | **納入先** | 製品の納入先 |
| **M** | **予定工数** | 作業ごとの予定工数（時間） |
| **N** | **実績工数** | 作業ごとの実績工数（工数シートから自動集計） |
| **O** | **進捗** | 作業ごとの進捗状況 |
| **P** | **仕掛日** | いずれかの進捗が「未着手」以外になった日（自動記録） |
| **Q** | **完了日** | 進捗が「完了」になった日（自動記録） |
| **R** | **作図期限** | 作図の提出期限 |
| **S** | **進捗記入者** | 最後に進捗を更新した担当者名（自動記録） |
| **T** | **更新日時** | 行データが最後に更新された日時（自動記録） |
| **U** | **係り超過理由**| 作業が遅延している場合の理由 |
| **V** | **注意点** | その案件に関する特記事項や注意点 |
| **W** | **備考** | その他の情報 |

### 3.2. 工数シート
* **データは3行目から開始**し、**2行目には日付ごとの工数合計**が自動で表示される。
| 列 | 列ヘッダー名 | 内容・役割 |
| :--- | :--- | :--- |
| **A** | **管理No.** | 案件の管理番号 |
| **B** | **作業区分** | 「盤配」か「線加工」かを表示 |
| **C** | **機番** | 参考情報として機番を表示 |
| **D** | **進捗** | 担当者が自分のシートで進捗を更新 |
| **E** | **予定工数** | メインシートから同期された予定工数 |
| **F** | **実績工数合計** | G列以降に入力された日々の工数の合計値（自動計算） |
| **G →** | **(日付)** | 日々の実績工数を時間単位で入力 |

---

## 4. 自動化機能の仕様

### 4.1. データ同期
* **メイン → 工数**: メインシートで案件の担当者が割り当てられると、その担当者の工数シートに該当案件の行が自動で追加される。担当者から外れると、行は自動で削除される。
* **工数 → メイン**: 工数シートで実績工数や進捗が編集されると、その内容はメインシートに即時自動で反映される。
* **担当者変更時のデータ保持**: 担当者を誤って変更し、元に戻した場合でも、過去に入力した工数データは失われずに復元される。

### 4.2. UI/UX（見た目と使いやすさ）
* **個人用フィルタ**:
    * 各ユーザーは、**他の共同編集者に影響を与えることなく**、自分専用のフィルタ表示を自由に利用できる。
    * カスタムメニューからワンクリックで**「自分の担当案件のみ表示」**が可能。
    * サイドバーから「進捗」など、他の列の条件も組み合わせて自由に絞り込みができる。
* **フィルタ状態の記憶**: 一度適用したフィルタは自動で記憶され、次回スプレッドシートを開いた際に自動で復元される。
* **マスタ連動の入力規則**: 「進捗」や「担当者」などの列には、各マスタシートの内容を基にしたドロップダウンリストが自動で設定される。マスタシートを更新すれば、選択肢も自動で更新される。
* **自動色付け**: 進捗、担当者、問い合わせ状況などに応じて、セルの背景色が自動で変更される。

### 4.3. Google Drive連携
* カスタムメニューから、メインシートの「機番」を基に資料フォルダを自動作成し、シートにリンクを自動で挿入する。
* 週次の自動バックアップ機能を持つ。

### 4.4. 請求シート連携
* カスタムメニューから、メインシートの情報を基にした請求用のシートを自動で作成・更新する。
* 請求シートでは、「盤配」と「線加工」は合算せず、それぞれ別の行として出力される。